const navBtn=document.getElementById("navToggle"),nav=document.getElementById("nav"),page=document.getElementById("page"),body=document.body;function showNav(){var e=document.createElement("div");e.classList.add("page__mask"),e.addEventListener("click",closeNav),page.appendChild(e),body.classList.add("show-nav")}function closeNav(){body.classList.remove("show-nav"),document.querySelector(".page__mask").remove()}navBtn.addEventListener("click",e=>{(body.classList.contains("show-nav")?closeNav:showNav)()});const modalBtn=document.querySelectorAll("[data-modal]"),modalClose=document.querySelectorAll(".modal__close"),modal=document.querySelectorAll(".modal");function closeModal(e){e.querySelector(".modal__inner").removeAttribute("style"),setTimeout(()=>{e.classList.remove("show"),body.classList.remove("no-scroll")},200)}modalBtn.forEach(e=>{e.addEventListener("click",e=>{e=e.currentTarget.getAttribute("data-modal"),e=document.getElementById(e);let t=e.querySelector(".modal__inner");t.addEventListener("click",e=>{e.stopPropagation()}),e.classList.add("show"),body.classList.add("no-scroll"),setTimeout(()=>{t.style.transform="none",t.style.opacity="1"},1)})}),modalClose.forEach(e=>{e.addEventListener("click",e=>{closeModal(e.currentTarget.closest(".modal"))})}),modal.forEach(e=>{e.addEventListener("click",e=>{closeModal(e.currentTarget)})});const textarea=document.querySelectorAll("[data-resize]"),commentForm=(textarea.forEach(e=>{let t=e.offsetHeight;e.addEventListener("input",e=>{e=e.target;e.style.height=t+"px",e.style.height=e.scrollHeight+"px"})}),document.querySelector(".commentForm")),commentFormH=commentForm.querySelector(".commentInput").offsetHeight,commentFormCopy=commentForm.cloneNode(!0),profileName=(commentFormCopy.classList.remove("mainComForm"),commentFormCopy.style["margin-top"]="1.5rem","John Martin"),profileAvatar="https://placehold.it/40";function newCommentHandler(e){e.preventDefault(),this.classList.contains("mainComForm")||((e=this.closest("li").querySelector(".cancelBtn")).removeEventListener("click",cancelHandler),e.classList.remove("cancelBtn"),e.classList.add("replyBtn"),e.innerText="ответить");var e=this.querySelector(".commentInput"),t=this.nextElementSibling,n=e.value;if(""==n)return this.remove(),null==t.children[0]&&t.remove(),0;var o=createElement("li","comments__item"),l=createElement("div","comments__header"),r=createElement("img","comments__img"),c=(r.src=profileAvatar,createElement("div","comments__author")),s=createElement("h5","comments__title",profileName),m=createElement("time","comments__date",`${(a=comDate(new Date))[2]}.${a[1]}.${a[0]}. ${a[3]}:`+a[4]),a=(m.setAttribute("dateTime",`${a[0]}-${a[1]}-${a[2]}T${a[3]}:`+a[4]),createElement("div","comments__text",n)),n=createElement("div","comments__btns commentBtns"),i=createElement("button","comments__reply deleteBtn","удалить"),d=(i.setAttribute("type","button"),createElement("button","comments__reply replyBtn","ответить"));d.setAttribute("type","button"),c.append(s,m),l.append(r,c),n.append(d,i),d.addEventListener("click",replyHandler),i.addEventListener("click",function(){var e=this.closest("ul");this.closest("li").remove(),null==e.children[0]&&(e.closest("li").querySelector(".hideBtn").remove(),e.remove())}),o.append(l,a,n),t.append(o),this.classList.contains("mainComForm")||(this.remove(),null==(m=(s=t.closest("li").querySelector(".commentBtns")).querySelector(".hideBtn"))&&((m=createElement("button","comments__reply comments__reply--all hideBtn","скрыть ответы")).addEventListener("click",hideHandler),s.append(m))),e.value="",e.focus()}function createElement(e,t,n=""){var o=document.createElement(e);for(item of t=t.split(" "))o.classList.add(item);return o.innerText=n,o}function comDate(e){return[""+e.getFullYear(),rigthTime(e.getMonth()+1),rigthTime(e.getDate()),rigthTime(e.getHours()),rigthTime(e.getMinutes())]}function rigthTime(e){return 1==(""+e).length?"0"+e:""+e}commentForm.addEventListener("submit",newCommentHandler);const replyButtons=document.querySelectorAll(".replyBtn"),hideButtons=document.querySelectorAll(".hideBtn");function replyHandler(e){e.preventDefault();var t,e=this.closest("li");let n=e.querySelector(".commentForm"),o=e.querySelector(".commentsList");null==o&&(o=createElement("ul","comments__list commentsList"),e.append(o)),null==n&&(n=commentFormCopy,o.parentNode.insertBefore(n,o),(t=n.querySelector(".commentInput")).addEventListener("input",e=>{e=e.target;e.style.height=commentFormH+"px",e.style.height=e.scrollHeight+"px"}),this.classList.remove("replyBtn"),this.classList.add("cancelBtn"),this.innerText="отмена",this.addEventListener("click",cancelHandler,{once:!0})),(t=n.querySelector(".commentInput")).focus(),n.addEventListener("submit",newCommentHandler),t.value="",t.style.height=commentFormH+"px"}function hideHandler(e){e.preventDefault();e=this.closest("li").querySelector(".commentsList");e.classList.toggle("hide"),this.innerText=e.classList.contains("hide")?"показать ответы":"скрыть ответы"}function cancelHandler(){var e=this.closest("li");e.querySelector(".commentForm").remove(),null==e.querySelector(".commentsList").children[0]&&e.querySelector(".commentsList").remove(),this.classList.remove("cancelBtn"),this.classList.add("replyBtn"),this.innerText="ответить"}replyButtons.forEach(e=>{e.addEventListener("click",replyHandler)}),hideButtons.forEach(e=>{e.addEventListener("click",hideHandler)});