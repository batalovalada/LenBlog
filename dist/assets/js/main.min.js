const navBtn=document.getElementById("navToggle"),nav=document.getElementById("nav"),page=document.getElementById("page"),body=document.body;function showNav(){var e=document.createElement("div");e.classList.add("page__mask"),e.addEventListener("click",closeNav),page.appendChild(e),body.classList.add("show-nav")}function closeNav(){body.classList.remove("show-nav"),document.querySelector(".page__mask").remove()}navBtn.addEventListener("click",e=>{(body.classList.contains("show-nav")?closeNav:showNav)()});const modalBtn=document.querySelectorAll("[data-modal]"),modalClose=document.querySelectorAll(".modal__close"),modal=document.querySelectorAll(".modal");function closeModal(e){e.querySelector(".modal__inner").removeAttribute("style"),setTimeout(()=>{e.classList.remove("show"),body.classList.remove("no-scroll")},200)}modalBtn.forEach(e=>{e.addEventListener("click",e=>{e=e.currentTarget.getAttribute("data-modal"),e=document.getElementById(e);let t=e.querySelector(".modal__inner");t.addEventListener("click",e=>{e.stopPropagation()}),e.classList.add("show"),body.classList.add("no-scroll"),setTimeout(()=>{t.style.transform="none",t.style.opacity="1"},1)})}),modalClose.forEach(e=>{e.addEventListener("click",e=>{closeModal(e.currentTarget.closest(".modal"))})}),modal.forEach(e=>{e.addEventListener("click",e=>{closeModal(e.currentTarget)})});const textarea=document.querySelectorAll("[data-resize]");function formValidation(e){function t(e){e=e.parentNode;e.classList.contains("form__error")&&(e.querySelector(".form__error-label").remove(),e.classList.remove("form__error"))}function n(e,t){var e=e.parentNode,n=document.createElement("label");n.classList.add("form__error-label"),n.textContent=t,e.classList.add("form__error"),e.append(n)}let o=!0;for(const r of e.querySelectorAll("input, textarea"))t(r),"true"!=r.dataset.email||r.value.match(/[-.\w]+@([\w-]+\.)+[\w-]+/g)||(t(r),n(r,"Email введён неверно!"),o=!1),"true"==r.dataset.required&&""==r.value&&(t(r),n(r,"Поле не заполнено!"),o=!1);return o}textarea.forEach(e=>{let t=e.offsetHeight;e.addEventListener("input",e=>{e=e.target;e.style.height=t+"px",e.style.height=e.scrollHeight+2+"px"})}),document.getElementById("messageForm").addEventListener("submit",function(e){e.preventDefault(),1==formValidation(this)&&alert("Сообшение отправлено успешно!")});const commentForm=document.querySelector(".commentForm"),commentFormH=commentForm.querySelector(".commentInput").offsetHeight,commentFormCopy=commentForm.cloneNode(!0),profileName=(commentFormCopy.classList.remove("mainComForm"),commentFormCopy.style["margin-top"]="1.5rem","John Martin"),profileAvatar="https://placehold.it/40";function newCommentHandler(e){e.preventDefault(),this.classList.contains("mainComForm")||((e=this.closest("li").querySelector(".cancelBtn")).removeEventListener("click",cancelHandler),e.classList.remove("cancelBtn"),e.classList.add("replyBtn"),e.innerText="ответить");var e=this.querySelector(".commentInput"),t=this.nextElementSibling,n=e.value;if(""==n)return this.remove(),null==t.children[0]&&t.remove(),0;var o=createElement("li","comments__item"),r=createElement("div","comments__header"),l=createElement("img","comments__img"),c=(l.src=profileAvatar,createElement("div","comments__author")),s=createElement("h5","comments__title",profileName),a=createElement("time","comments__date",`${(m=comDate(new Date))[2]}.${m[1]}.${m[0]}. ${m[3]}:`+m[4]),m=(a.setAttribute("dateTime",`${m[0]}-${m[1]}-${m[2]}T${m[3]}:`+m[4]),createElement("div","comments__text",n)),n=createElement("div","comments__btns commentBtns"),i=createElement("button","comments__reply deleteBtn","удалить"),d=(i.setAttribute("type","button"),createElement("button","comments__reply replyBtn","ответить"));d.setAttribute("type","button"),c.append(s,a),r.append(l,c),n.append(d,i),d.addEventListener("click",replyHandler),i.addEventListener("click",function(){var e=this.closest("ul");this.closest("li").remove(),null==e.children[0]&&(e.closest("li").querySelector(".hideBtn").remove(),e.remove())}),o.append(r,m,n),t.append(o),this.classList.contains("mainComForm")||(this.remove(),null==(a=(s=t.closest("li").querySelector(".commentBtns")).querySelector(".hideBtn"))&&((a=createElement("button","comments__reply comments__reply--all hideBtn","скрыть ответы")).addEventListener("click",hideHandler),s.append(a))),e.value="",e.style.height=commentFormH+"px",e.focus()}function createElement(e,t,n=""){var o=document.createElement(e);for(item of t=t.split(" "))o.classList.add(item);return o.innerText=n,o}function comDate(e){return[""+e.getFullYear(),rigthTime(e.getMonth()+1),rigthTime(e.getDate()),rigthTime(e.getHours()),rigthTime(e.getMinutes())]}function rigthTime(e){return 1==(""+e).length?"0"+e:""+e}commentForm.addEventListener("submit",newCommentHandler);const replyButtons=document.querySelectorAll(".replyBtn"),hideButtons=document.querySelectorAll(".hideBtn");function replyHandler(e){e.preventDefault();e=this.closest("li");let t=e.querySelector(".commentForm"),n=e.querySelector(".commentsList");null==n&&(n=createElement("ul","comments__list commentsList"),e.append(n)),null==t&&(t=commentFormCopy.cloneNode(!0),n.parentNode.insertBefore(t,n),this.classList.remove("replyBtn"),this.classList.add("cancelBtn"),this.innerText="отмена",this.addEventListener("click",cancelHandler,{once:!0}));e=t.querySelector(".commentInput");e.addEventListener("input",e=>{e=e.target;e.style.height=commentFormH+"px",e.style.height=e.scrollHeight+2+"px"}),e.focus(),t.addEventListener("submit",newCommentHandler),e.value="",e.style.height=commentFormH+"px"}function hideHandler(e){e.preventDefault();e=this.closest("li").querySelector(".commentsList");e.classList.toggle("hide"),this.innerText=e.classList.contains("hide")?"показать ответы":"скрыть ответы"}function cancelHandler(){var e=this.closest("li");e.querySelector(".commentForm").remove(),null==e.querySelector(".commentsList").children[0]&&e.querySelector(".commentsList").remove(),this.classList.remove("cancelBtn"),this.classList.add("replyBtn"),this.innerText="ответить"}replyButtons.forEach(e=>{e.addEventListener("click",replyHandler)}),hideButtons.forEach(e=>{e.addEventListener("click",hideHandler)});