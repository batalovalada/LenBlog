const commentForm=document.querySelector(".commentForm"),commentFormH=commentForm.querySelector(".commentInput").offsetHeight,commentFormCopy=commentForm.cloneNode(!0),profileName=(commentFormCopy.classList.remove("mainComForm"),commentFormCopy.style["margin-top"]="1.5rem","John Martin"),profileAvatar="https://placehold.it/40";function newCommentHandler(e){e.preventDefault(),this.classList.contains("mainComForm")||((e=this.closest("li").querySelector(".cancelBtn")).removeEventListener("click",cancelHandler),e.classList.remove("cancelBtn"),e.classList.add("replyBtn"),e.innerText="ответить");var e=this.querySelector(".commentInput"),t=this.nextElementSibling,n=e.value;if(""==n)return this.remove(),null==t.children[0]&&t.remove(),0;var r=createElement("li","comments__item"),m=createElement("div","comments__header"),o=createElement("img","comments__img"),l=(o.src=profileAvatar,createElement("div","comments__author")),c=createElement("h5","comments__title",profileName),i=createElement("time","comments__date",`${(s=getDate(new Date))[2]}.${s[1]}.${s[0]}. ${s[3]}:`+s[4]),s=(i.setAttribute("dateTime",`${s[0]}-${s[1]}-${s[2]}T${s[3]}:`+s[4]),createElement("div","comments__text",n)),n=createElement("div","comments__btns commentBtns"),a=createElement("button","comments__reply deleteBtn","удалить"),d=(a.setAttribute("type","button"),createElement("button","comments__reply replyBtn","ответить"));d.setAttribute("type","button"),l.append(c,i),m.append(o,l),n.append(d,a),d.addEventListener("click",replyHandler),a.addEventListener("click",function(){var e=this.closest("ul");this.closest("li").remove(),null==e.children[0]&&(e.closest("li").querySelector(".hideBtn").remove(),e.remove())}),r.append(m,s,n),t.append(r),this.classList.contains("mainComForm")||(this.remove(),null==(i=(c=t.closest("li").querySelector(".commentBtns")).querySelector(".hideBtn"))&&((i=createElement("button","comments__reply comments__reply--all hideBtn","скрыть ответы")).addEventListener("click",hideHandler),c.append(i))),e.value="",e.style.height=commentFormH+"px",e.focus()}function createElement(e,t,n=""){var r=document.createElement(e);for(item of t=t.split(" "))r.classList.add(item);return r.innerText=n,r}commentForm.addEventListener("submit",newCommentHandler);const replyButtons=document.querySelectorAll(".replyBtn"),hideButtons=document.querySelectorAll(".hideBtn");function replyHandler(e){e.preventDefault();e=this.closest("li");let t=e.querySelector(".commentForm"),n=e.querySelector(".commentsList");null==n&&(n=createElement("ul","comments__list commentsList"),e.append(n)),null==t&&(t=commentFormCopy.cloneNode(!0),n.parentNode.insertBefore(t,n),this.classList.remove("replyBtn"),this.classList.add("cancelBtn"),this.innerText="отмена",this.addEventListener("click",cancelHandler,{once:!0}));e=t.querySelector(".commentInput");e.addEventListener("input",e=>{e=e.target;e.style.height=commentFormH+"px",e.style.height=e.scrollHeight+2+"px"}),e.focus(),t.addEventListener("submit",newCommentHandler),e.value="",e.style.height=commentFormH+"px"}function hideHandler(e){e.preventDefault();e=this.closest("li").querySelector(".commentsList");e.classList.toggle("hide"),this.innerText=e.classList.contains("hide")?"показать ответы":"скрыть ответы"}function cancelHandler(){var e=this.closest("li");e.querySelector(".commentForm").remove(),null==e.querySelector(".commentsList").children[0]&&e.querySelector(".commentsList").remove(),this.classList.remove("cancelBtn"),this.classList.add("replyBtn"),this.innerText="ответить"}function getDate(e){return[""+e.getFullYear(),rigthTime(e.getMonth()+1),rigthTime(e.getDate()),rigthTime(e.getHours()),rigthTime(e.getMinutes())]}function rigthTime(e){return 1==(""+e).length?"0"+e:""+e}replyButtons.forEach(e=>{e.addEventListener("click",replyHandler)}),hideButtons.forEach(e=>{e.addEventListener("click",hideHandler)});